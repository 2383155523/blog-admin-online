{"version":3,"file":"index.9ae2e376.js","sources":["../../src/components/admin/routeContent/components/blogArticles/index.vue"],"sourcesContent":["<script lang=\"ts\" setup>\r\nimport { ref, h, computed, unref, onMounted, watch } from \"vue\";\r\nimport { NDataTable, NInput, NButton, NTag } from \"naive-ui\";\r\nimport { useStore } from \"vuex\";\r\nimport { useRouter } from \"vue-router\";\r\nimport { isPC } from \"@/hooks/resize\";\r\nimport colorArr from \"@/config/color\";\r\n\r\nconst router = useRouter();\r\nconst pagination = {\r\n  pageSize: 12,\r\n};\r\nconst store = useStore();\r\nconst checkedRowKeysRef = ref([]);\r\nconst sortStatesRef = ref([]);\r\nconst classifyBox = ref<null | HTMLElement>(null);\r\nconst tableMaxHeight = ref<string>(\"\");\r\n// offsetHeight\r\nconst initTableMaxHeight = () => {\r\n  tableMaxHeight.value = classifyBox.value.offsetHeight - 170 + \"\";\r\n};\r\n\r\nonMounted(() => {\r\n  initTableMaxHeight();\r\n});\r\nconst sortKeyMapOrderRef = computed(() =>\r\n  sortStatesRef.value.reduce((result, { columnKey, order }) => {\r\n    result[columnKey] = order;\r\n    return result;\r\n  }, {})\r\n);\r\n\r\nconst handleCheck = (rowKeys) => {\r\n  checkedRowKeysRef.value = rowKeys;\r\n};\r\nconst createData = (len: number) => {\r\n  const dataArr = [];\r\n  for (let i = 0; i < len; i++) {\r\n    dataArr.push({\r\n      Id: i,\r\n      Title: `Title${i}`,\r\n      Classify: `Classify${i}`,\r\n      Tag: i % 2 == 0 ? `js|html|vue|react|vite` : `js|html|vue`,\r\n      ReadTotal: i * 2,\r\n      State: i % 2 == 0 ? \"已发布\" : \"待发布\",\r\n      Date: new Date().toLocaleString(),\r\n      isEdit: false,\r\n    });\r\n  }\r\n  return dataArr;\r\n};\r\n\r\nconst data = ref(createData(20));\r\n\r\nconst headers = computed(() => [\r\n  {\r\n    type: \"selection\",\r\n  },\r\n  {\r\n    title: \"Title\",\r\n    key: \"Title\",\r\n    align: \"center\",\r\n    ellipsis: {\r\n      tooltip: true,\r\n    },\r\n  },\r\n  {\r\n    title: \"Classify\",\r\n    key: \"Classify\",\r\n    align: \"center\",\r\n    ellipsis: {\r\n      tooltip: true,\r\n    },\r\n  },\r\n  {\r\n    title: \"Tag\",\r\n    key: \"Tag\",\r\n    align: \"center\",\r\n    ellipsis: {\r\n      tooltip: true,\r\n    },\r\n    render(row, index) {\r\n      return h(\r\n        \"div\",\r\n        {},\r\n        {\r\n          default() {\r\n            const VNodes = [];\r\n            row.Tag.split(\"|\").forEach((item, index) => {\r\n              VNodes.push(\r\n                h(\r\n                  NTag,\r\n                  {\r\n                    color: {\r\n                      color: colorArr[index],\r\n                      borderColor: colorArr[index],\r\n                    },\r\n                    style: \"margin-right:10px;border-radius: 4px;\",\r\n                  },\r\n                  {\r\n                    default() {\r\n                      return item;\r\n                    },\r\n                  }\r\n                )\r\n              );\r\n            });\r\n            return VNodes;\r\n          },\r\n        }\r\n      );\r\n    },\r\n  },\r\n  {\r\n    title: \"ReadTotal\",\r\n    key: \"ReadTotal\",\r\n    ellipsis: {\r\n      tooltip: true,\r\n    },\r\n    align: \"center\",\r\n    sortOrder: sortKeyMapOrderRef.value.ReadTotal || false,\r\n    sorter(rowA, rowB) {\r\n      return rowA.ReadTotal - rowB.ReadTotal;\r\n    },\r\n  },\r\n  {\r\n    title: \"State\",\r\n    key: \"State\",\r\n    ellipsis: {\r\n      tooltip: true,\r\n    },\r\n    align: \"center\",\r\n  },\r\n  {\r\n    title: \"Date\",\r\n    key: \"Date\",\r\n    align: \"center\",\r\n    ellipsis: {\r\n      tooltip: true,\r\n    },\r\n  },\r\n\r\n  {\r\n    title: \"Action\",\r\n    key: \"Action\",\r\n    align: \"center\",\r\n    render(row, index) {\r\n      const editArticle = () => {\r\n        router.push({\r\n          name: \"editBlogArticle\",\r\n          params: {\r\n            data: row,\r\n          },\r\n        });\r\n      };\r\n      const deleteArticle = () => {\r\n        console.log(\"delete\");\r\n      };\r\n      return h(\r\n        \"div\",\r\n        {\r\n          class: \"action\",\r\n        },\r\n        {\r\n          default() {\r\n            return [\r\n              h(\r\n                NButton,\r\n                {\r\n                  onClick: editArticle,\r\n                  type: \"primary\",\r\n                  style: `margin-right:20px;margin-bottom:${\r\n                    isPC.value ? \"0\" : \"10px\"\r\n                  }`,\r\n                },\r\n                {\r\n                  default() {\r\n                    return \"Edit\";\r\n                  },\r\n                }\r\n              ),\r\n              h(\r\n                NButton,\r\n                { onClick: deleteArticle, type: \"error\" },\r\n                {\r\n                  default() {\r\n                    return \"Delete\";\r\n                  },\r\n                }\r\n              ),\r\n            ];\r\n          },\r\n        }\r\n      );\r\n    },\r\n  },\r\n]);\r\nfunction handleUpdateSorter(sorters) {\r\n  console.log(sorters);\r\n  sortStatesRef.value = [].concat(sorters);\r\n}\r\nconst searchTitleKey = ref<string | null>(null); //博文标题 查询关键字\r\nconst searchClassifyKey = ref<string | null>(null); //分类 查询关键字\r\nconst searchTagKey = ref<string | null>(null); //标签 查询关键字\r\nconst coypData = unref(data);\r\nwatch(searchTitleKey, (newVal) => {\r\n  if (newVal == \"\") {\r\n    data.value = coypData;\r\n  }\r\n  data.value = unref(data).filter((item) =>\r\n    item.Title.toLocaleLowerCase().includes(newVal.trim().toLowerCase())\r\n  );\r\n});\r\nwatch(searchClassifyKey, (newVal) => {\r\n  if (newVal == \"\") {\r\n    data.value = coypData;\r\n  }\r\n  data.value = unref(data).filter((item) =>\r\n    item.Classify.toLocaleLowerCase().includes(newVal.trim().toLowerCase())\r\n  );\r\n});\r\nwatch(searchTagKey, (newVal) => {\r\n  if (newVal == \"\") {\r\n    data.value = coypData;\r\n  }\r\n  data.value = unref(data).filter((item) =>\r\n    item.Tag.toLocaleLowerCase().includes(newVal.trim().toLowerCase())\r\n  );\r\n});\r\nconst newArticle = () => {\r\n  router.push({\r\n    name: \"editBlogArticle\",\r\n  });\r\n};\r\n</script>\r\n<template>\r\n  <div\r\n    class=\"classifyBox\"\r\n    ref=\"classifyBox\"\r\n    :style=\"{\r\n      background: store.state.theme == 'light' ? '#fff' : '#333',\r\n    }\"\r\n  >\r\n    <div style=\"margin-bottom: 20px\" class=\"actions\">\r\n      <n-button type=\"primary\" style=\"margin-right: 30px\" @click=\"newArticle\"\r\n        >+ New</n-button\r\n      >\r\n      <n-button type=\"error\" style=\"margin-right: 30px\">DeleteAll</n-button>\r\n      <n-input\r\n        v-model:value=\"searchTitleKey\"\r\n        type=\"text\"\r\n        placeholder=\"Search About Title\"\r\n        clearable\r\n        style=\"width: 250px; margin-right: 30px\"\r\n        class=\"input\"\r\n      />\r\n      <n-input\r\n        v-model:value=\"searchClassifyKey\"\r\n        type=\"text\"\r\n        placeholder=\"Search About Classify\"\r\n        clearable\r\n        style=\"width: 250px; margin-right: 30px\"\r\n        class=\"input\"\r\n      />\r\n      <n-input\r\n        v-model:value=\"searchTagKey\"\r\n        type=\"text\"\r\n        placeholder=\"Search About Tag\"\r\n        clearable\r\n        style=\"width: 250px\"\r\n        class=\"input\"\r\n      />\r\n    </div>\r\n    <n-data-table\r\n      :columns=\"headers\"\r\n      :data=\"data\"\r\n      :pagination=\"pagination\"\r\n      :row-key=\"(row) => row.Id\"\r\n      @update:checked-row-keys=\"handleCheck\"\r\n      @update:sorter=\"handleUpdateSorter\"\r\n      striped\r\n      :max-height=\"tableMaxHeight\"\r\n    >\r\n    </n-data-table>\r\n  </div>\r\n</template>\r\n<style lang=\"scss\" scoped>\r\n.classifyBox {\r\n  width: 100%;\r\n  height: 100%;\r\n  border-radius: 4px;\r\n  box-sizing: border-box;\r\n  padding: 15px 10px;\r\n  transition: background-color 0.3s var(--n-bezier);\r\n}\r\n\r\n@media (max-width: 768px) {\r\n  .actions .input {\r\n    margin-top: 20px;\r\n  }\r\n}\r\n</style>\r\n"],"names":["colorArr"],"mappings":"uZAQM,GAAS,IACT,EAAa,CACjB,SAAU,IAEN,EAAQ,IACR,EAAoB,EAAI,IACxB,EAAgB,EAAI,IACpB,EAAc,EAAwB,MACtC,EAAiB,EAAY,IAE7B,EAAqB,IAAM,GAChB,MAAQ,EAAY,MAAM,aAAe,IAAM,MAGtD,IAAM,YAGV,GAAqB,EAAS,IAClC,EAAc,MAAM,OAAO,CAAC,EAAQ,CAAE,YAAW,cACxC,GAAa,EACb,GACN,KAGC,EAAc,AAAC,GAAY,GACb,MAAQ,GAmBtB,EAAO,EAAI,AAjBE,CAAC,GAAgB,MAC5B,GAAU,UACP,GAAI,EAAG,EAAI,EAAK,MACf,KAAK,CACX,GAAI,EACJ,MAAO,QAAQ,IACf,SAAU,WAAW,IACrB,IAAK,EAAI,GAAK,EAAI,yBAA2B,cAC7C,UAAW,EAAI,EACf,MAAO,EAAI,GAAK,EAAI,qBAAQ,qBAC5B,KAAM,GAAI,QAAO,iBACjB,OAAQ,WAGL,KAGmB,KAEtB,EAAU,EAAS,IAAM,CAC7B,CACE,KAAM,aAER,CACE,MAAO,QACP,IAAK,QACL,MAAO,SACP,SAAU,CACR,QAAS,KAGb,CACE,MAAO,WACP,IAAK,WACL,MAAO,SACP,SAAU,CACR,QAAS,KAGb,CACE,MAAO,MACP,IAAK,MACL,MAAO,SACP,SAAU,CACR,QAAS,IAEX,OAAO,EAAK,EAAO,OACV,GACL,MACA,GACA,CACE,SAAU,MACF,GAAS,YACX,IAAI,MAAM,KAAK,QAAQ,CAAC,EAAM,IAAU,GACnC,KACL,EACE,EACA,CACE,MAAO,CACL,MAAOA,EAAS,GAChB,YAAaA,EAAS,IAExB,MAAO,yCAET,CACE,SAAU,OACD,SAMV,OAMjB,CACE,MAAO,YACP,IAAK,YACL,SAAU,CACR,QAAS,IAEX,MAAO,SACP,UAAW,EAAmB,MAAM,WAAa,GACjD,OAAO,EAAM,EAAM,OACV,GAAK,UAAY,EAAK,YAGjC,CACE,MAAO,QACP,IAAK,QACL,SAAU,CACR,QAAS,IAEX,MAAO,UAET,CACE,MAAO,OACP,IAAK,OACL,MAAO,SACP,SAAU,CACR,QAAS,KAIb,CACE,MAAO,SACP,IAAK,SACL,MAAO,SACP,OAAO,EAAK,EAAO,MACX,GAAc,IAAM,GACjB,KAAK,CACV,KAAM,kBACN,OAAQ,CACN,KAAM,MAIN,EAAgB,IAAM,SAClB,IAAI,iBAEP,GACL,MACA,CACE,MAAO,UAET,CACE,SAAU,OACD,CACL,EACE,EACA,CACE,QAAS,EACT,KAAM,UACN,MAAO,mCACL,EAAK,MAAQ,IAAM,UAGvB,CACE,SAAU,OACD,UAIb,EACE,EACA,CAAE,QAAS,EAAe,KAAM,SAChC,CACE,SAAU,OACD,+BAWC,EAAS,SAC3B,IAAI,KACE,MAAQ,GAAG,OAAO,QAE5B,GAAiB,EAAmB,MACpC,EAAoB,EAAmB,MACvC,EAAe,EAAmB,MAClC,EAAW,EAAM,KACjB,EAAgB,AAAC,GAAW,CAC5B,GAAU,OACP,MAAQ,KAEV,MAAQ,EAAM,GAAM,OAAO,AAAC,GAC/B,EAAK,MAAM,oBAAoB,SAAS,EAAO,OAAO,oBAGpD,EAAmB,AAAC,GAAW,CAC/B,GAAU,OACP,MAAQ,KAEV,MAAQ,EAAM,GAAM,OAAO,AAAC,GAC/B,EAAK,SAAS,oBAAoB,SAAS,EAAO,OAAO,oBAGvD,EAAc,AAAC,GAAW,CAC1B,GAAU,OACP,MAAQ,KAEV,MAAQ,EAAM,GAAM,OAAO,AAAC,GAC/B,EAAK,IAAI,oBAAoB,SAAS,EAAO,OAAO,uBAGlD,GAAa,IAAM,GAChB,KAAK,CACV,KAAM"}