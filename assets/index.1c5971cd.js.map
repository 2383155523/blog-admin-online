{"version":3,"file":"index.1c5971cd.js","sources":["../../src/components/admin/routeContent/components/classifyBlogArticle/index.vue"],"sourcesContent":["<script lang=\"ts\" setup>\r\nimport { ref, h, computed, unref, onMounted, watch } from \"vue\";\r\nimport {\r\n  NDataTable,\r\n  NInput,\r\n  NButton,\r\n  NModal,\r\n  NCard,\r\n  useMessage,\r\n} from \"naive-ui\";\r\nimport { useStore } from \"vuex\";\r\nimport { useRouter } from \"vue-router\";\r\nimport { isPC } from \"@/hooks/resize\";\r\n\r\nconst router = useRouter();\r\nconst pagination = {\r\n  pageSize: 12,\r\n};\r\nconst store = useStore();\r\nconst message = useMessage();\r\nconst checkedRowKeysRef = ref([]);\r\nconst sortStatesRef = ref([]);\r\nconst classifyBox = ref<null | HTMLElement>(null);\r\nconst tableMaxHeight = ref<string>(\"\");\r\n// offsetHeight\r\nconst initTableMaxHeight = () => {\r\n  tableMaxHeight.value = classifyBox.value.offsetHeight - 170 + \"\";\r\n};\r\n\r\nonMounted(() => {\r\n  initTableMaxHeight();\r\n});\r\n\r\nconst sortKeyMapOrderRef = computed(() =>\r\n  sortStatesRef.value.reduce((result, { columnKey, order }) => {\r\n    result[columnKey] = order;\r\n    return result;\r\n  }, {})\r\n);\r\n\r\nconst handleCheck = (rowKeys) => {\r\n  checkedRowKeysRef.value = rowKeys;\r\n};\r\nconst createData = (len: number) => {\r\n  const dataArr = [];\r\n  for (let i = 0; i < len; i++) {\r\n    dataArr.push({\r\n      Id: i,\r\n      Name: `name${i}`,\r\n      Date: new Date().toLocaleString(),\r\n      ArticlesTotal: i * 10,\r\n      isEdit: false,\r\n    });\r\n  }\r\n  return dataArr;\r\n};\r\n\r\nconst data = ref(createData(200));\r\nconst showModal = ref<boolean>(false);\r\nconst ClassifyName = ref<string>(\"\");\r\nconst input_state = ref<string>(\"undefined\");\r\nconst btnLoading = ref<boolean>(false);\r\nconst btnDisabled = ref<boolean>(false);\r\nconst createClassify = () => {\r\n  showModal.value = true;\r\n};\r\nwatch(ClassifyName, (newVal) => {\r\n  if (newVal.trim() === \"\") {\r\n    input_state.value = \"error\";\r\n  } else {\r\n    input_state.value = \"success\";\r\n  }\r\n});\r\nconst confirmCreateClassify = () => {\r\n  if (ClassifyName.value.trim() == \"\") {\r\n    input_state.value = \"error\";\r\n    message.warning(\"请输入分类名称!\");\r\n    return;\r\n  }\r\n  btnLoading.value = true;\r\n  btnDisabled.value = true;\r\n  input_state.value = \"success\";\r\n  setTimeout(() => {\r\n    showModal.value = false;\r\n    btnLoading.value = false;\r\n    btnDisabled.value = false;\r\n  }, 2000);\r\n};\r\nconst search = ref<string | null>(null);\r\nconst coypData = unref(data);\r\nwatch(search, (newVal) => {\r\n  if (newVal == \"\") {\r\n    data.value = coypData;\r\n  }\r\n  data.value = unref(data).filter((item) =>\r\n    item.Name.toLocaleLowerCase().includes(newVal.trim().toLowerCase())\r\n  );\r\n});\r\nconst headers = computed(() => [\r\n  {\r\n    type: \"selection\",\r\n  },\r\n  {\r\n    title: \"Id\",\r\n    key: \"Id\",\r\n    align: \"center\",\r\n  },\r\n  {\r\n    title: \"Name\",\r\n    key: \"Name\",\r\n    align: \"center\",\r\n    ellipsis: {\r\n      tooltip: true,\r\n    },\r\n    render(row, index) {\r\n      if (row.isEdit) {\r\n        return h(NInput, {\r\n          value: row.Name,\r\n          onUpdateValue(v) {\r\n            data.value[index].Name = v;\r\n          },\r\n          onKeyup(e) {\r\n            if (e.code == \"Enter\") {\r\n              const { Id, Name } = unref(row);\r\n              row.isEdit = false;\r\n              console.log(Id, Name);\r\n              // console.log(id);\r\n            }\r\n          },\r\n        });\r\n      } else {\r\n        return h(\"div\", row.Name);\r\n      }\r\n    },\r\n  },\r\n  {\r\n    title: \"Date\",\r\n    key: \"Date\",\r\n    align: \"center\",\r\n    ellipsis: {\r\n      tooltip: true,\r\n    },\r\n  },\r\n  {\r\n    title: \"ArticlesTotal\",\r\n    key: \"ArticlesTotal\",\r\n    align: \"center\",\r\n    sortOrder: sortKeyMapOrderRef.value.ArticlesTotal || false,\r\n    sorter(rowA, rowB) {\r\n      return rowA.ArticlesTotal - rowB.ArticlesTotal;\r\n    },\r\n  },\r\n  {\r\n    title: \"Action\",\r\n    key: \"Action\",\r\n    align: \"center\",\r\n    render(row, index) {\r\n      const editArticle = () => {\r\n        row.isEdit = !row.isEdit;\r\n      };\r\n      const deleteArticle = () => {\r\n        console.log(\"delete\");\r\n      };\r\n      const goDetail = () => {};\r\n      return h(\r\n        \"div\",\r\n        {\r\n          class: \"action\",\r\n        },\r\n        {\r\n          default() {\r\n            return [\r\n              h(\r\n                NButton,\r\n                {\r\n                  onClick: editArticle,\r\n                  type: \"primary\",\r\n                  style: `margin-right:20px;margin-bottom:${\r\n                    isPC.value ? \"0\" : \"10px\"\r\n                  }`,\r\n                },\r\n                {\r\n                  default() {\r\n                    return row.isEdit ? \"Cancel\" : \"Edit\";\r\n                  },\r\n                }\r\n              ),\r\n              h(\r\n                NButton,\r\n                {\r\n                  onClick: goDetail,\r\n                  type: \"info\",\r\n                  style: `margin-right:20px;margin-bottom:${\r\n                    isPC.value ? \"0\" : \"10px\"\r\n                  }`,\r\n                },\r\n                {\r\n                  default() {\r\n                    return \"Detail\";\r\n                  },\r\n                }\r\n              ),\r\n              h(\r\n                NButton,\r\n                { onClick: deleteArticle, type: \"error\" },\r\n                {\r\n                  default() {\r\n                    return \"Delete\";\r\n                  },\r\n                }\r\n              ),\r\n            ];\r\n          },\r\n        }\r\n      );\r\n    },\r\n  },\r\n]);\r\nfunction handleUpdateSorter(sorters) {\r\n  console.log(sorters);\r\n  sortStatesRef.value = [].concat(sorters);\r\n}\r\n</script>\r\n<template>\r\n  <div\r\n    class=\"classifyBox\"\r\n    ref=\"classifyBox\"\r\n    :style=\"{\r\n      background: store.state.theme == 'light' ? '#fff' : '#333',\r\n    }\"\r\n  >\r\n    <div style=\"margin-bottom: 20px\">\r\n      <n-button\r\n        type=\"primary\"\r\n        style=\"margin-right: 30px\"\r\n        @click=\"createClassify\"\r\n        >+ New</n-button\r\n      >\r\n      <n-button type=\"error\" style=\"margin-right: 30px\">DeleteAll</n-button>\r\n      <n-input\r\n        v-model:value=\"search\"\r\n        type=\"text\"\r\n        placeholder=\"Search About Name\"\r\n        clearable\r\n        style=\"width: 200px\"\r\n      />\r\n    </div>\r\n    <n-data-table\r\n      :columns=\"headers\"\r\n      :data=\"data\"\r\n      :pagination=\"pagination\"\r\n      :row-key=\"(row) => row.Id\"\r\n      @update:checked-row-keys=\"handleCheck\"\r\n      @update:sorter=\"handleUpdateSorter\"\r\n      striped\r\n      :max-height=\"tableMaxHeight\"\r\n    >\r\n    </n-data-table>\r\n    <n-modal v-model:show=\"showModal\">\r\n      <n-card\r\n        style=\"width: 600px\"\r\n        title=\"+ New Classify\"\r\n        :bordered=\"false\"\r\n        size=\"huge\"\r\n        role=\"dialog\"\r\n        aria-modal=\"true\"\r\n      >\r\n        <n-input\r\n          v-model:value=\"ClassifyName\"\r\n          type=\"text\"\r\n          placeholder=\"Write Classify Name\"\r\n          clearable\r\n          :status=\"input_state\"\r\n        />\r\n        <template #footer>\r\n          <div class=\"modalAction\">\r\n            <n-button type=\"error\" @click=\"showModal = false\">Cancel</n-button>\r\n            <n-button\r\n              type=\"success\"\r\n              @click=\"confirmCreateClassify\"\r\n              :loading=\"btnLoading\"\r\n              :disabled=\"btnDisabled\"\r\n              >{{ btnDisabled ? \"\" : \"Create\" }}</n-button\r\n            >\r\n          </div>\r\n        </template>\r\n      </n-card>\r\n    </n-modal>\r\n  </div>\r\n</template>\r\n<style lang=\"scss\" scoped>\r\n.modalAction {\r\n  display: flex;\r\n  justify-content: space-between;\r\n}\r\n\r\n.classifyBox {\r\n  width: 100%;\r\n  height: 100%;\r\n  border-radius: 4px;\r\n  box-sizing: border-box;\r\n  padding: 15px 10px;\r\n  transition: background-color 0.3s var(--n-bezier);\r\n}\r\n</style>\r\n"],"names":[],"mappings":"2ZAce,SACT,GAAa,CACjB,SAAU,IAEN,EAAQ,IACR,EAAU,IACV,EAAoB,EAAI,IACxB,EAAgB,EAAI,IACpB,EAAc,EAAwB,MACtC,EAAiB,EAAY,IAE7B,EAAqB,IAAM,GAChB,MAAQ,EAAY,MAAM,aAAe,IAAM,MAGtD,IAAM,YAIV,GAAqB,EAAS,IAClC,EAAc,MAAM,OAAO,CAAC,EAAQ,CAAE,YAAW,cACxC,GAAa,EACb,GACN,KAGC,EAAc,AAAC,GAAY,GACb,MAAQ,GAgBtB,EAAO,EAAI,AAdE,CAAC,GAAgB,MAC5B,GAAU,UACP,GAAI,EAAG,EAAI,EAAK,MACf,KAAK,CACX,GAAI,EACJ,KAAM,OAAO,IACb,KAAM,GAAI,QAAO,iBACjB,cAAe,EAAI,GACnB,OAAQ,WAGL,KAGmB,MACtB,EAAY,EAAa,IACzB,EAAe,EAAY,IAC3B,EAAc,EAAY,aAC1B,EAAa,EAAa,IAC1B,EAAc,EAAa,IAC3B,EAAiB,IAAM,GACjB,MAAQ,MAEd,EAAc,AAAC,GAAW,CAC1B,EAAO,SAAW,KACR,MAAQ,UAER,MAAQ,iBAGlB,GAAwB,IAAM,IAC9B,EAAa,MAAM,QAAU,GAAI,GACvB,MAAQ,UACZ,QAAQ,wDAGP,MAAQ,KACP,MAAQ,KACR,MAAQ,qBACT,IAAM,GACL,MAAQ,KACP,MAAQ,KACP,MAAQ,IACnB,MAEC,EAAS,EAAmB,MAC5B,EAAW,EAAM,KACjB,EAAQ,AAAC,GAAW,CACpB,GAAU,OACP,MAAQ,KAEV,MAAQ,EAAM,GAAM,OAAO,AAAC,GAC/B,EAAK,KAAK,oBAAoB,SAAS,EAAO,OAAO,uBAGnD,GAAU,EAAS,IAAM,CAC7B,CACE,KAAM,aAER,CACE,MAAO,KACP,IAAK,KACL,MAAO,UAET,CACE,MAAO,OACP,IAAK,OACL,MAAO,SACP,SAAU,CACR,QAAS,IAEX,OAAO,EAAK,EAAO,OACb,GAAI,OACC,EAAE,EAAQ,CACf,MAAO,EAAI,KACX,cAAc,EAAG,GACV,MAAM,GAAO,KAAO,GAE3B,QAAQ,EAAG,IACL,EAAE,MAAQ,QAAS,MACf,CAAE,KAAI,QAAS,EAAM,KACvB,OAAS,WACL,IAAI,EAAI,OAMf,EAAE,MAAO,EAAI,QAI1B,CACE,MAAO,OACP,IAAK,OACL,MAAO,SACP,SAAU,CACR,QAAS,KAGb,CACE,MAAO,gBACP,IAAK,gBACL,MAAO,SACP,UAAW,EAAmB,MAAM,eAAiB,GACrD,OAAO,EAAM,EAAM,OACV,GAAK,cAAgB,EAAK,gBAGrC,CACE,MAAO,SACP,IAAK,SACL,MAAO,SACP,OAAO,EAAK,EAAO,MACX,GAAc,IAAM,GACpB,OAAS,CAAC,EAAI,QAEd,EAAgB,IAAM,SAClB,IAAI,WAER,EAAW,IAAM,SAChB,GACL,MACA,CACE,MAAO,UAET,CACE,SAAU,OACD,CACL,EACE,EACA,CACE,QAAS,EACT,KAAM,UACN,MAAO,mCACL,EAAK,MAAQ,IAAM,UAGvB,CACE,SAAU,OACD,GAAI,OAAS,SAAW,UAIrC,EACE,EACA,CACE,QAAS,EACT,KAAM,OACN,MAAO,mCACL,EAAK,MAAQ,IAAM,UAGvB,CACE,SAAU,OACD,YAIb,EACE,EACA,CAAE,QAAS,EAAe,KAAM,SAChC,CACE,SAAU,OACD,+BAWC,EAAS,SAC3B,IAAI,KACE,MAAQ,GAAG,OAAO"}