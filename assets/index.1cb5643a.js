import{u as R}from"./vuex.fa60dc2b.js";import{b as T}from"./vue-router.9966525b.js";import{i as L}from"./resize.b816c2d2.js";import{p as _,g as I}from"./index.3fa5d1e3.js";import{_ as S}from"./index.85902041.js";import{f as M,r,j as K,b as H,h as u,X as n,w as B,aF as P,ad as z,ae as O,ak as i,b5 as j,a0 as V,c as X}from"./@vue.3182ba0d.js";import{w as $,u as q,x as p,t as h,y as G}from"./naive-ui.50411a32.js";import"./axios.0309b134.js";import"./aplayer.feb7d914.js";import"./plyr.e249d6ea.js";import"./vueuc.f520d797.js";import"./evtd.5b1ed12a.js";import"./seemly.bd85dbed.js";import"./@css-render.4d849085.js";import"./vooks.54ac2ec9.js";import"./vdirs.03f40802.js";import"./resize-observer-polyfill.8deb1e21.js";import"./css-render.d5050412.js";import"./@emotion.6322e2ae.js";import"./lodash-es.48bbfd83.js";import"./date-fns.ecfd739c.js";import"./treemate.6d922cc8.js";const J=async()=>await I("getOriginComments"),Q=async o=>await I("deleteComment",o),W=async o=>await _("deleteManyComment",o),Y=async o=>await _("updateCommentContent",o);const Z={style:{"margin-bottom":"20px"},class:"actions"},ee=X("DeleteAll"),te=M({setup(o){T();const c={pageSize:12},x=$(),l=q(),b=R(),m=r([]),k=r(null),A=r(""),E=r(!0),w=()=>{A.value=k.value.offsetHeight-170+""},d=async()=>{a.value.length=0,(await J()).data.forEach(t=>{a.value.push({Id:t.id,Content:t.content,ArticleName:t.articleName,ReplyId:t.replyId?t.replyId:"\u65E0",UserName:t.userName,Date:new Date(parseInt(t.date)).toLocaleString(),isEdit:!1})})};K(()=>{w(),setTimeout(()=>{d(),E.value=!1},1e3)});const D=e=>{m.value=e},a=r([]),F=H(()=>[{type:"selection"},{title:"Id",key:"Id",align:"center"},{title:"Content",key:"Content",align:"center",ellipsis:{tooltip:!0},render(e,t){return e.isEdit?u(p,{value:e.Content,onUpdateValue(s){a.value[t].Content=s},async onKeyup(s){if(s.code=="Enter"){const{Id:C,Content:N}=n(e);e.isEdit=!1,(await Y({content:N,id:C})).state?(l.success("\u4FEE\u6539\u8BC4\u8BBA\u5185\u5BB9\u6210\u529F"),d()):l.error("\u4FEE\u6539\u8BC4\u8BBA\u5185\u5BB9\u5931\u8D25")}}}):u("div",e.Content)}},{title:"ArticleName",key:"ArticleName",align:"center"},{title:"ReplyId",key:"ReplyId",align:"center"},{title:"UserName",key:"UserName",align:"center"},{title:"Date",key:"Date",align:"center",ellipsis:{tooltip:!0}},{title:"Action",key:"Action",align:"center",render(e,t){const s=()=>{e.isEdit=!e.isEdit},C=()=>{x.error({title:"\u662F\u5426\u5220\u9664\u8BC4\u8BBA",positiveText:"\u662F",negativeText:"\u7B97\u4E86",onPositiveClick:async()=>{(await Q({id:e.Id})).state?(l.success("\u8BC4\u8BBA\u5220\u9664\u6210\u529F"),d()):l.error("\u8BC4\u8BBA\u5220\u9664\u5931\u8D25")},onNegativeClick:()=>{}})};return u("div",{class:"action"},{default(){return[u(h,{onClick:s,type:"primary",style:`margin-right:20px;margin-bottom:${L.value?"0":"10px"}`},{default(){return e.isEdit?"Cancel":"Edit"}}),u(h,{onClick:C,type:"error"},{default(){return"Delete"}})]}})}}]),y=r(null),v=r(null),g=r(null),f=n(a);B(y,e=>{e==""&&(a.value=f),a.value=n(a).filter(t=>t.ArticleName.toLocaleLowerCase().includes(e.trim().toLowerCase()))}),B(v,e=>{e==""&&(a.value=f),a.value=n(a).filter(t=>t.UserName.toLocaleLowerCase().includes(e.trim().toLowerCase()))}),B(g,e=>{e==""&&(a.value=f),a.value=n(a).filter(t=>t.ReplyId.toString().includes(e.trim()))});const U=()=>{if(m.value.length==0){l.warning("\u8BF7\u52FE\u9009\u81F3\u5C11\u4E00\u4E2A\u8981\u5220\u9664\u7684\u8BC4\u8BBA");return}x.error({title:"\u5426\u5220\u9664\u52FE\u9009\u7684\u8BC4\u8BBA",positiveText:"\u662F",negativeText:"\u7B97\u4E86",onPositiveClick:async()=>{(await W({commentIds:m.value})).state?(l.success("\u8BC4\u8BBA\u5220\u9664\u6210\u529F"),d()):l.error("\u8BC4\u8BBA\u5220\u9664\u5931\u8D25")},onNegativeClick:()=>{}})};return(e,t)=>(P(),z("div",{class:"classifyBox",ref_key:"classifyBox",ref:k,style:V({background:n(b).state.theme=="light"?"#fff":"#333"})},[O("div",Z,[i(n(h),{type:"error",style:{"margin-right":"30px"},onClick:U},{default:j(()=>[ee]),_:1}),i(n(p),{value:y.value,"onUpdate:value":t[0]||(t[0]=s=>y.value=s),type:"text",placeholder:"Search About ArticleName",clearable:"",style:{width:"250px","margin-right":"30px"},class:"input"},null,8,["value"]),i(n(p),{value:v.value,"onUpdate:value":t[1]||(t[1]=s=>v.value=s),type:"text",placeholder:"Search About UserName",clearable:"",style:{width:"250px","margin-right":"30px"},class:"input"},null,8,["value"]),i(n(p),{value:g.value,"onUpdate:value":t[2]||(t[2]=s=>g.value=s),type:"text",placeholder:"Search About ReplyId",clearable:"",style:{width:"250px"},class:"input"},null,8,["value"])]),i(n(G),{columns:n(F),data:a.value,pagination:c,"row-key":s=>s.Id,"onUpdate:checkedRowKeys":D,striped:"","max-height":A.value,loading:E.value},null,8,["columns","data","row-key","max-height","loading"])],4))}});var Ne=S(te,[["__scopeId","data-v-29d3f395"]]);export{Ne as default};
